<!doctype html><html lang="ru-RU" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Оптимизация кода на С++" /><meta name="author" content="Deynega Vasiliy" /><meta property="og:locale" content="ru_RU" /><meta name="description" content="Иногда бывает сложно решить, какую конструкцию лучше использовать i++ или ++i, либо выбрать между конструкцией if-else и switch. В этой статье, написанной специально для сообщества iT works, представлены наиболее реальные средства оптимизации кода, которые должен знать каждый профессиональный программист. Некоторые считают, что времена оптимизации на уровне кода прошли навсегда, однако это не так. Сейчас существует множество платформ в которых нет таких могущественных компиляторов как в Microsoft Visual Studio. Например шейдерные языки (hlsl, glsl) или код для CUDA, PlayStation3, SPU или мобильные платформы. В зависимости от организации кода, может в десятки раз отличаться его эффективность иногда из-за неэффективности компилятора, на чаще из-за доступа к памяти. Программируя для разных платформ изучите возможности вашего компилятора и особенности архитектуры процессора (если вы пишите для конкретной консоли). Проведите тесты производительности разных вариантов оптимизации. Часто сложно предполагать, какие именно способы будут наиболее эффективными. А эта статья подскажет разные приемы, которые могут вам помочь. Однако не следует оптимизировать слепо, без предварительного анализа и профилирования. Помните, что преждевременная оптимизация - это зло." /><meta property="og:description" content="Иногда бывает сложно решить, какую конструкцию лучше использовать i++ или ++i, либо выбрать между конструкцией if-else и switch. В этой статье, написанной специально для сообщества iT works, представлены наиболее реальные средства оптимизации кода, которые должен знать каждый профессиональный программист. Некоторые считают, что времена оптимизации на уровне кода прошли навсегда, однако это не так. Сейчас существует множество платформ в которых нет таких могущественных компиляторов как в Microsoft Visual Studio. Например шейдерные языки (hlsl, glsl) или код для CUDA, PlayStation3, SPU или мобильные платформы. В зависимости от организации кода, может в десятки раз отличаться его эффективность иногда из-за неэффективности компилятора, на чаще из-за доступа к памяти. Программируя для разных платформ изучите возможности вашего компилятора и особенности архитектуры процессора (если вы пишите для конкретной консоли). Проведите тесты производительности разных вариантов оптимизации. Часто сложно предполагать, какие именно способы будут наиболее эффективными. А эта статья подскажет разные приемы, которые могут вам помочь. Однако не следует оптимизировать слепо, без предварительного анализа и профилирования. Помните, что преждевременная оптимизация - это зло." /><link rel="canonical" href="http://itw66.ru/blog/c_plus_plus/13.html" /><meta property="og:url" content="http://itw66.ru/blog/c_plus_plus/13.html" /><meta property="og:site_name" content="It Works!" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2010-08-31T00:00:00+06:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Оптимизация кода на С++" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Deynega Vasiliy","url":"http://illi-studio.ru"},"dateModified":"2023-07-10T10:22:21+05:00","datePublished":"2010-08-31T00:00:00+06:00","description":"Иногда бывает сложно решить, какую конструкцию лучше использовать i++ или ++i, либо выбрать между конструкцией if-else и switch. В этой статье, написанной специально для сообщества iT works, представлены наиболее реальные средства оптимизации кода, которые должен знать каждый профессиональный программист. Некоторые считают, что времена оптимизации на уровне кода прошли навсегда, однако это не так. Сейчас существует множество платформ в которых нет таких могущественных компиляторов как в Microsoft Visual Studio. Например шейдерные языки (hlsl, glsl) или код для CUDA, PlayStation3, SPU или мобильные платформы. В зависимости от организации кода, может в десятки раз отличаться его эффективность иногда из-за неэффективности компилятора, на чаще из-за доступа к памяти. Программируя для разных платформ изучите возможности вашего компилятора и особенности архитектуры процессора (если вы пишите для конкретной консоли). Проведите тесты производительности разных вариантов оптимизации. Часто сложно предполагать, какие именно способы будут наиболее эффективными. А эта статья подскажет разные приемы, которые могут вам помочь. Однако не следует оптимизировать слепо, без предварительного анализа и профилирования. Помните, что преждевременная оптимизация - это зло.","headline":"Оптимизация кода на С++","mainEntityOfPage":{"@type":"WebPage","@id":"http://itw66.ru/blog/c_plus_plus/13.html"},"url":"http://itw66.ru/blog/c_plus_plus/13.html"}</script><title>Оптимизация кода на С++ | It Works!</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="It Works!"><meta name="application-name" content="It Works!"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"> <img src="/assets/img/logo.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"> </a><div class="site-title"> <a href="/">It Works!</a></div><div class="site-subtitle fst-italic">Научно-популярный портал о технологиях настоящего и будущего!</div></div><ul class="nav flex-column flex-grow-1 w-100 ps-0"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>ДОМАШНЯЯ СТРАНИЦА</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>КАТЕГОРИИ</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>ТЕГИ</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>АРХИВ</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>О САЙТЕ</span> </a></ul><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/mrdekk/itw66.ru" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container px-xxl-5"><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100" > <span id="breadcrumb"> <span> <a href="/"> Домашняя страница </a> </span> <span>Оптимизация кода на С++ </span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Публикация</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Поиск..." > </span> <span id="search-cancel">Отменить</span></div></div><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pe-xl-4"><div class="post px-1 px-md-2"><h1 data-toc-skip>Оптимизация кода на С++</h1><div class="post-meta text-muted"> <span> Время публикации <em class="" data-ts="1283191200" data-df="DD/MM/YYYY" data-bs-toggle="tooltip" data-bs-placement="bottom" > 31/08/2010 </em> </span> <span> Обновлено <em class="" data-ts="1688966541" data-df="DD/MM/YYYY" data-bs-toggle="tooltip" data-bs-placement="bottom" > 10/07/2023 </em> </span><div class="d-flex justify-content-between"> <span> Автор <em> <a href="http://illi-studio.ru">Deynega Vasiliy</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="2315 слов" > <em>12 минут</em> чтения</span></div></div></div><div class="post-content"><p>Иногда бывает сложно решить, какую конструкцию лучше использовать i++ или ++i, либо выбрать между конструкцией if-else и switch. В этой статье, написанной специально для сообщества iT works, представлены наиболее реальные средства оптимизации кода, которые должен знать каждый профессиональный программист.</p><p>Некоторые считают, что времена оптимизации на уровне кода прошли навсегда, однако это не так. Сейчас существует множество платформ в которых нет таких могущественных компиляторов как в Microsoft Visual Studio. Например шейдерные языки (hlsl, glsl) или код для CUDA, PlayStation3, SPU или мобильные платформы. В зависимости от организации кода, может в десятки раз отличаться его эффективность иногда из-за неэффективности компилятора, на чаще из-за доступа к памяти.</p><p>Программируя для разных платформ изучите возможности вашего компилятора и особенности архитектуры процессора (если вы пишите для конкретной консоли). Проведите тесты производительности разных вариантов оптимизации. Часто сложно предполагать, какие именно способы будут наиболее эффективными. А эта статья подскажет разные приемы, которые могут вам помочь. Однако не следует оптимизировать слепо, без предварительного анализа и профилирования. Помните, что преждевременная оптимизация - это зло.</p><p>Если вы являетесь программистом в VS под Windows, то скорее всего со многими описанными приемами оптимизации компилятор эффективно справится. Обратите внимание на пункты работы с памятью, а так же я рекомендую ознакомиться с техникой <em>Data oriented design</em>. Некоторые советы по ее использования ищите в статье <a href="http://itw66.ru/blog/c_plus_plus/491.html">Методы оптимизации памяти</a>.</p><p>Итак, начнем:</p><ol><li>Используйте векторизацию данных и векторные команды их обработки (например SSE в CPU или упаковывайте данные если используете шейдеры или CUDA). Это позволит использовать SIMD (Single Instruction, Multiple Data) архитектуру, что значительно повысит скорость вычислений. Если вы решите использовать этот метод, то не забывайте про выравнивание данных в памяти.<li>Эффективнее складывать и умножать в перемешку, чем сначала все сложить, а потом все умножить. Это происходит от того, что сложение и умножение выполняются разными модулями процессора и могут выполняться одновременно.<div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre> <span class="kt">int</span> <span class="p">[</span><span class="kt">float</span><span class="p">,</span> <span class="kt">double</span><span class="p">,</span> <span class="n">single</span><span class="p">,</span> <span class="kt">unsigned</span><span class="p">]</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">,</span><span class="n">f3</span><span class="p">,</span><span class="n">g1</span><span class="p">,</span><span class="n">g2</span><span class="p">,</span><span class="n">g3</span><span class="p">;</span>
 <span class="n">a</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="err">с</span><span class="p">;</span>
 <span class="n">k</span> <span class="o">=</span> <span class="n">m</span> <span class="o">+</span> <span class="n">n</span><span class="p">;</span>
 <span class="n">t</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">;</span>
 <span class="n">f1</span> <span class="o">=</span> <span class="n">f2</span> <span class="o">*</span> <span class="n">f3</span><span class="p">;</span>
 <span class="n">g1</span> <span class="o">=</span> <span class="n">g2</span> <span class="o">*</span> <span class="n">g3</span><span class="p">;</span>
    
    
 <span class="err">Менее</span> <span class="err">эффективно</span> <span class="err">чем</span><span class="o">:</span>
 <span class="n">a</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="err">с</span><span class="p">;</span>
 <span class="n">f1</span> <span class="o">=</span> <span class="n">f2</span> <span class="o">*</span> <span class="n">f3</span><span class="p">;</span>
 <span class="n">k</span> <span class="o">=</span> <span class="n">m</span> <span class="o">+</span> <span class="n">n</span><span class="p">;</span>
 <span class="n">g1</span> <span class="o">=</span> <span class="n">g2</span> <span class="o">*</span> <span class="n">g3</span><span class="p">;</span>
 <span class="n">t</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="p">;</span>
</pre></table></code></div></div><li>Нет разницы по скорости в работе с float и double при сложении и умножении. Они выполняются за равное число тактов процессора и используют одни и те же регистры. При делении и извлечении корня, float работает быстрее. Однако если вы будете использовать большие объемы данных, то за счет кеша быстрее будет работать тот тип, который занимает меньше памяти (т.е. float), поэтому в общем случае именно его предпочтительно использовать. Выбирать double имеет смысл когда нужна большая точность. 4.Допустим есть.<div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> <span class="k">const</span> <span class="kt">float</span> <span class="n">a</span> <span class="o">=</span> <span class="mf">100.0</span><span class="n">f</span><span class="p">;</span>
 <span class="kt">float</span> <span class="n">some1</span> <span class="o">=</span> <span class="n">some3</span> <span class="o">*</span> <span class="mf">1.0</span><span class="n">f</span> <span class="o">/</span> <span class="n">a</span><span class="p">;</span>
 <span class="kt">float</span> <span class="n">some2</span> <span class="o">=</span> <span class="n">some4</span> <span class="o">*</span> <span class="mf">1.0</span><span class="n">f</span> <span class="o">/</span> <span class="n">a</span><span class="p">;</span>
</pre></table></code></div></div><p>более эффективно написать не:</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> <span class="k">const</span> <span class="kt">float</span> <span class="n">a_inv</span> <span class="o">=</span> <span class="mf">1.0</span><span class="n">f</span> <span class="o">/</span> <span class="n">a</span><span class="p">;</span>
 <span class="n">some1</span> <span class="o">=</span> <span class="n">some3</span> <span class="o">*</span> <span class="n">a_inv</span><span class="p">;</span>
 <span class="n">some2</span> <span class="o">=</span> <span class="n">some4</span> <span class="o">*</span> <span class="n">a_inv</span><span class="p">;</span>
</pre></table></code></div></div><p>а так:</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> <span class="n">some1</span> <span class="o">=</span> <span class="n">some3</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span><span class="n">f</span> <span class="o">/</span> <span class="n">a</span><span class="p">);</span>
 <span class="n">some2</span> <span class="o">=</span> <span class="n">some4</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span><span class="n">f</span> <span class="o">/</span> <span class="n">a</span><span class="p">);</span>
</pre></table></code></div></div><p>Почему это будет эффективнее? Операторы с равным приоритетом выполняются последовательно. Это значит, что будет выполнено сначала умножение, а затем деление. Если же обрамить операцию деления в скобки, то ее выполнит компилятор, а в реальном времени будет выполняться только операция умножения. Что качается отличий варианта 3 от варианта 2, то в 3-ем варианте не создается дополнительной переменной, нет нужны глядя на код думать о том, что это за переменная. А эффективность 2-го и 3-го варианты будет одинаковой.</p><li>На больших объемах данных и вычислений на них float выгоднее чем double (из за cache miss’ов, см. пункт 3).<li>a, b - любое выражение, Func1, Func2 - функции, которые вызовутся для вычисления условия<div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> <span class="k">if</span><span class="p">(</span> <span class="n">a</span> <span class="o">&amp;&amp;</span> <span class="n">b</span> <span class="p">)</span> <span class="o">-</span> <span class="err">нужно</span> <span class="err">первым</span> <span class="err">ставить</span> <span class="err">менее</span> <span class="err">вероятное</span> <span class="err">условие</span><span class="p">,</span> <span class="err">для</span> <span class="err">большей</span> <span class="err">эффективности</span>
 <span class="k">if</span><span class="p">(</span> <span class="n">a</span> <span class="o">||</span> <span class="n">b</span> <span class="p">)</span> <span class="o">-</span> <span class="err">нужно</span> <span class="err">первым</span> <span class="err">ставить</span> <span class="err">более</span> <span class="err">вероятное</span> <span class="err">условие</span><span class="p">,</span> <span class="err">для</span> <span class="err">большей</span> <span class="err">эффективности</span>
 <span class="k">if</span><span class="p">(</span> <span class="n">Func1</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">Func2</span><span class="p">()</span> <span class="p">)</span> <span class="o">-</span> <span class="err">нужно</span> <span class="err">ставить</span> <span class="err">более</span> <span class="err">быстрый</span> <span class="err">оператор</span> <span class="err">первым</span>
</pre></table></code></div></div><li>пусть<div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre> <span class="kt">void</span> <span class="nf">Func</span><span class="p">(</span> <span class="kt">int</span><span class="o">*</span> <span class="n">a</span> <span class="p">)</span>
 <span class="p">{</span>
    <span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
    
   <span class="err">Следующие</span> <span class="err">строки</span> <span class="err">одинаковые</span> <span class="err">по</span> <span class="err">эффективности</span> <span class="p">(</span><span class="err">по</span> <span class="err">времени</span> <span class="err">выполнения</span><span class="p">)</span><span class="o">:</span>
    <span class="n">b</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
    <span class="o">*</span><span class="n">a</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
 <span class="p">}</span>
</pre></table></code></div></div><p>Это происходит по тому, что доступ к стековой переменной осуществляется по указателю на стек. Тоже идет разыменование указателя.</p><li>Если есть большой массив структур, то нужно делать размер его элементов равным степени двойки. Тогда проход по такому массиву будет значительно быстрее (в 4 -6 раз), за счет выравнивания указателя на каждую структуру в массиве.<li>пусть<div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> <span class="kt">int</span> <span class="n">a</span><span class="p">[</span> <span class="mi">1000</span> <span class="p">];</span>
 <span class="k">for</span><span class="p">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">1000</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
    <span class="n">a</span><span class="p">[</span> <span class="n">i</span> <span class="p">]</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>
</pre></table></code></div></div><p>Значительно эффективнее будет:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> int* p = a;
 for( int i =0; i&lt;1000; ++i, ++p )
   *p = 50;
</pre></table></code></div></div><li>пусть<div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">SomeClass</span><span class="o">*</span> <span class="n">p</span><span class="p">;</span> <span class="o">-</span> <span class="err">указатель</span> <span class="err">на</span> <span class="err">массив</span> <span class="err">элементов</span>
<span class="n">x</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">p</span><span class="o">++</span><span class="p">);</span> <span class="o">-</span> <span class="err">значительно</span> <span class="err">эффективнее</span>
<span class="n">x</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="o">++</span><span class="n">p</span><span class="p">);</span>
</pre></table></code></div></div><p>По той же причине что и пункт 1. В первом случае будет осуществляться разыменование указателя и его инкремент параллельно, а во втором - последовательно.</p><li>Количество колонок двумерного массива желательно должно быть равно степени двойки. Это увеличит скорость работы с массивом. Это выравняет указатели на первые элементы каждой строки, что ускорит доступ к элементам.<div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="kt">int</span> <span class="n">mas</span><span class="p">[</span> <span class="mi">10</span> <span class="p">][</span> <span class="mi">16</span>  <span class="o">-</span>  <span class="err">количество</span> <span class="err">колонок</span> <span class="err">желательно</span> <span class="err">должно</span> <span class="err">быть</span> <span class="err">равно</span> <span class="err">степени</span> <span class="err">двойки</span> <span class="p">]</span>
</pre></table></code></div></div><li>пусть<div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">u32</span> <span class="n">a</span><span class="p">;</span> <span class="n">f32</span> <span class="n">b</span><span class="p">;</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">f32</span><span class="p">)(</span><span class="n">i32</span><span class="p">)</span><span class="n">a</span><span class="p">;</span> <span class="o">-</span> <span class="err">быстрее</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">f32</span><span class="p">)</span><span class="n">a</span><span class="p">;</span>
</pre></table></code></div></div><li>Избегайте операции приведения типов.<div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kt">float</span> <span class="n">f</span><span class="p">;</span> <span class="kt">int</span> <span class="n">a</span><span class="p">;</span>
<span class="kt">float</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">a</span><span class="p">;</span> <span class="o">-</span> <span class="err">долго</span>
<span class="kt">int</span> <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">f</span><span class="p">;</span> <span class="o">-</span> <span class="err">очень</span> <span class="err">долго</span>
</pre></table></code></div></div><li>Разумно используйте операции округления:<div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="err">только</span> <span class="err">для</span> <span class="kt">unsigned</span><span class="o">:</span>
<span class="p">(</span><span class="n">u32</span><span class="p">)</span><span class="n">x</span> <span class="n">are</span> <span class="mi">10</span><span class="n">x</span> <span class="n">times</span> <span class="n">faster</span> <span class="n">than</span> <span class="err">'</span><span class="n">u32</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="err">'</span>
<span class="n">u32</span><span class="p">(</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">1.0</span><span class="n">f</span> <span class="p">)</span> <span class="n">are</span> <span class="mi">10</span><span class="n">x</span> <span class="n">times</span> <span class="n">faster</span> <span class="n">than</span> <span class="err">'</span><span class="n">u32</span><span class="p">(</span><span class="n">cell</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="err">'</span>
<span class="n">u32</span><span class="p">(</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.5</span><span class="n">f</span> <span class="p">)</span> <span class="n">are</span> <span class="mi">10</span><span class="n">x</span> <span class="n">times</span> <span class="n">faster</span> <span class="n">than</span> <span class="err">'</span><span class="n">u32</span><span class="p">(</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="err">'</span>
</pre></table></code></div></div><li>пусть<div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kt">float</span> <span class="n">f</span> <span class="o">=</span> <span class="mf">1.0</span><span class="n">f</span><span class="p">;</span>
<span class="o">*</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">f</span> <span class="o">^=</span> <span class="mh">0x80000000</span><span class="p">;</span> <span class="o">-</span> <span class="err">быстрее</span> <span class="err">чем</span>
<span class="n">f</span>  <span class="o">*=</span>  <span class="o">-</span><span class="mf">1.0</span><span class="n">f</span><span class="p">;</span>
</pre></table></code></div></div><li>Если в switch используются последовательные значения параметров case ( case 0: case 1: case 2:…) то switch значительно эффективнее чем if-else. Это происходит за счет того, что при if-else будет вычисляться значение каждого условия, а в случае таких параметров в конструкции switch значение будет вычислено один раз, а затем будет переход сразу к нужному пункту.<li><p>Ветвления - это зло. Старайтесь сокращать их количество. Не делайте их внутри больших циклов. switch - это тоже ветвление. Процессор старается предсказывать результат условия (branch prediction) и если значение выражение почти всегда одно и то же, то ветвление не отразится на скорости выполнения кода. Однако в общем случае, предсказание ветвления будет не верно в 50% случаев, что будет замедлять выполнение алгоритма. Каждое ветвление - это переход к последовательности команд процессора. Такой переход ломает конвейер команд процессора и стоит достаточно дорого. Это особенно актуально для шейдеров, SPU подпрограмм, CUDA подпрограмм и в алгоритмах, где идет обработка большого количества данных. Если вам нужно для ста тысяч частиц выполнить какой то код, то постарайтесь минимизировать количество ветвлений. Это может существенно ускорить выполнение кода.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">const</span> <span class="kt">int</span> <span class="n">NN</span> <span class="o">=</span> <span class="mi">12500000</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</pre></table></code></div></div><p>следующее плохо (200ms на моей машине):</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="k">for</span><span class="p">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">NN</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">switch</span><span class="p">(</span> <span class="n">i</span> <span class="o">%</span> <span class="n">N</span> <span class="p">)</span>
    <span class="p">{</span>
    <span class="k">case</span> <span class="mi">0</span><span class="p">:</span>        <span class="n">res</span> <span class="o">+=</span> <span class="mi">10</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="mi">3</span><span class="p">:</span>        <span class="n">res</span> <span class="o">+=</span> <span class="mi">30</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="mi">5</span><span class="p">:</span>        <span class="n">res</span> <span class="o">+=</span> <span class="mi">50</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="mi">6</span><span class="p">:</span>        <span class="n">res</span> <span class="o">+=</span> <span class="mi">60</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="mi">8</span><span class="p">:</span>        <span class="n">res</span> <span class="o">+=</span> <span class="mi">80</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>    
</pre></table></code></div></div><p>гораздо лучше (120 ms на моей машине):</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">const</span> <span class="kt">int</span> <span class="n">arr</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">0</span> <span class="p">};</span>
<span class="k">for</span><span class="p">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">NN</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="n">arr</span><span class="p">[</span> <span class="n">i</span> <span class="o">%</span> <span class="n">N</span> <span class="p">];</span>
</pre></table></code></div></div><li><p>Рассмотрим пример. Двумерный спрайт содержит массив вершин vertex[ 4 ]. Гораздо эффективнее было бы сделать одно хранилище вершин, а в спрайте индекс смещения относительно первого элемента. Это по памяти сэкономит 16 байт на каждый спрайт, а по скорости будет процентов на 30 быстрее проход по вершинам. Это data orientad design. Для С# он так же справедлив.</p><p>Основные направления оптимизаций:</p><ol><li>Уменьшение числа ветвлений<li>Группировка данных по одинаковым типам в памяти (в C# никто еще не отменял массивы структур)<li>Уменьшение размеров структур</ol><li><p>inline функции:</p><p>’* дает выигрыш в скорости ‘+ увелечивает код ‘+ добавляет в код зависимости (*.h файлов) при компиляции. Это увеличивает время и объем компиляции при изменении кода в функции</p><p>Факты:</p><ol><li>компилятор может не встроить функцию (даже _forceinlie - нет горантии встраивания)<li>VS компилятор при включенной оптимизацией по скорости встраивает любые функции по своему усмотрению, даже если они не объявлены как inline.</ol><p>Вывод: нужно избегать использования inline функций. Сейчас это не необходимо. Исключением может быть только очень часто выполняемый низкоуровневый код (как например математические функции) или, если вы пишите программу используя компилятор без полной оптимизации кода (например для компилятора под PlayStation3 использование inline до сих пор актуально).</p><li>Рассмотрим результат смены порядка переменных в структуре.<div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="k">struct</span> <span class="nc">s1</span>
<span class="p">{</span>
  <span class="kt">short</span> <span class="kt">int</span> <span class="n">a</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">b</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">d</span><span class="p">;</span> 
<span class="p">}</span>
<span class="k">sizeof</span><span class="p">(</span><span class="n">s1</span><span class="p">[</span> <span class="mi">10</span> <span class="p">])</span> <span class="o">==</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">10</span>
    
<span class="k">struct</span> <span class="nc">s2</span>
<span class="p">{</span>
  <span class="kt">double</span> <span class="n">b</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">d</span><span class="p">;</span> 
  <span class="kt">short</span> <span class="kt">int</span> <span class="n">a</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">sizeof</span><span class="p">(</span><span class="n">s1</span><span class="p">[</span> <span class="mi">10</span> <span class="p">])</span> <span class="o">==</span> <span class="mi">16</span> <span class="o">*</span> <span class="mi">10</span>
</pre></table></code></div></div><p>double по 8 выравнивается всегда</p><li>От перестановки мест слогаемых для float value, сумма меняется:<div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="mf">1e+8</span><span class="n">f</span> <span class="o">+</span> <span class="mf">1.23456</span> <span class="o">-</span> <span class="mf">1e+8</span><span class="n">f</span> <span class="o">==</span> <span class="mi">0</span> <span class="err">но</span>
<span class="mf">1e+8</span><span class="n">f</span> <span class="o">-</span> <span class="mf">1e+8</span><span class="n">f</span> <span class="o">+</span> <span class="mf">1.23456</span> <span class="o">==</span>  <span class="mf">1.23456</span>
</pre></table></code></div></div><li>Бинарный поиск не следует использовать на малом количестве элементов. Если количество элементов меньше чем 40-60 (это число может варьироваться от реализации алгоритмов, но имеет примерно такой порядок), бинарный поиск будет медленнее линейного.<li>Можно так:<div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="kt">bool</span> <span class="n">b</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="n">b</span> <span class="o">?</span> <span class="n">x</span> <span class="o">:</span> <span class="n">y</span><span class="p">;</span>
</pre></table></code></div></div><p>Но быстрее:</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="kt">int</span> <span class="n">b</span><span class="p">;</span> <span class="p">(</span> <span class="mi">0</span> <span class="o">-</span> <span class="nb">false</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">-</span> <span class="nb">true</span><span class="p">)</span>
<span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="n">b</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">y</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">b</span><span class="p">);</span>
</pre></table></code></div></div><li>пусть ```cpp int a, b;<ol><li>int x = (a &gt;= b ? 1 : 0);<li>int x = (a &gt;= b ? -1 : 0); ```</ol><p>Можно заменить на:</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="mf">1.</span> <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">31</span><span class="p">;</span>
<span class="mf">2.</span> <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x80000000</span><span class="p">;</span>
</pre></table></code></div></div><li>пусть<div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">i32</span> <span class="n">iIndex</span><span class="p">;</span>
</pre></table></code></div></div><p>Условие:</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">if</span><span class="p">(</span> <span class="n">iIndex</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">iIndex</span> <span class="o">&gt;=</span> <span class="n">iSize</span> <span class="p">)</span>
</pre></table></code></div></div><p>Можно заменить таким:</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">if</span><span class="p">(</span> <span class="p">(</span><span class="n">u32</span><span class="p">)</span><span class="n">iIndex</span> <span class="o">&gt;=</span> <span class="n">iSize</span> <span class="p">)</span>
</pre></table></code></div></div><p>Условие:</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">if</span><span class="p">(</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">min</span> <span class="o">&amp;&amp;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">max</span> <span class="p">)</span>
</pre></table></code></div></div><p>Можно заменить таким:</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">if</span><span class="p">(</span> <span class="p">(</span><span class="n">u32</span><span class="p">)(</span><span class="n">i</span><span class="o">-</span><span class="n">min</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">u32</span><span class="p">)</span><span class="n">max</span> <span class="o">-</span> <span class="n">min</span> <span class="p">)</span>
</pre></table></code></div></div><li>Выше был пример, как можно switch превратить в static const array и обращаться по индексу. Это применимо например для rtti (run time type identification). Если таким образом определены switch указателей на функции, то замена его доступом к нужной функции за константное время - может быть крайне полезна. То же самое - если это машина состояний. Вместо того, чтобы добавлять новый элемент в свитч, его можно добавлять в массив выше. Но помните про пункт 16.<div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="kt">int</span> <span class="nf">func</span><span class="p">(</span> <span class="kt">int</span> <span class="n">index</span> <span class="p">)</span>
<span class="p">{</span>
   <span class="k">switch</span><span class="p">(</span> <span class="n">index</span> <span class="p">)</span>
  <span class="p">{</span>
     <span class="k">case</span> <span class="mi">0</span> <span class="p">:</span> <span class="k">return</span> <span class="n">f_Func1</span><span class="p">();</span> 
     <span class="k">case</span> <span class="mi">3</span> <span class="p">:</span> <span class="k">return</span> <span class="n">f_Func2</span><span class="p">();</span>
     <span class="k">case</span> <span class="mi">4</span> <span class="p">:</span> <span class="k">return</span> <span class="n">f_Func2</span><span class="p">();</span>
<span class="p">..</span>
     <span class="k">case</span> <span class="p">..</span> <span class="k">return</span> <span class="n">f_FuncN</span><span class="p">():</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>заменить на:</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="kt">int</span> <span class="nf">func</span><span class="p">(</span> <span class="kt">int</span> <span class="n">index</span> <span class="p">)</span>
<span class="p">{</span>
   <span class="k">static</span> <span class="n">funcPtr</span> <span class="n">array</span><span class="p">[]</span> <span class="o">=</span> 
   <span class="p">{</span> 
      <span class="o">&amp;</span><span class="n">f_Func1</span><span class="p">,</span>
      <span class="nb">NULL</span><span class="p">,</span>
      <span class="o">&amp;</span><span class="n">f_Func2</span><span class="p">,</span>
      <span class="p">...</span>
      <span class="o">&amp;</span><span class="n">f_FuncN</span>
   <span class="p">}</span>
   <span class="k">return</span> <span class="n">array</span><span class="p">[</span> <span class="n">index</span> <span class="p">]();</span>
<span class="p">}</span>
</pre></table></code></div></div></ol><h4 id="дополнительно"><span class="me-2">Дополнительно</span><a href="#дополнительно" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Дополнительные рекомендации по написанию более эффективного кода, можно найти в статьях:</p><ul><li><a href="http://itw66.ru/blog/c_plus_plus/571.html">Эффективный код на С++</a><li><a href="http://itw66.ru/blog/c_plus_plus/491.html">Методы оптимизации памяти</a></ul><p>Для более глубокого понимания способов оптимизации советую почитать этот мануалы:</p><ul><li><a href="http://www.agner.org/optimize/optimizing_cpp.pdf">Optimizing software in C++. An optimization guide for Windows, Linux and Mac platforms </a><li><a href="http://www.tantalon.com/pete/cppopt/main.htm">C++ Optimization Strategies and Techniques</a></ul><p>Книги по оптимизации:</p><ul><li><a href="http://www.amazon.com/Video-Game-Optimization-Eric-Preisz/dp/1598634356">Video Game Optimization</a><li><a href="http://it-ebooks.ru/publ/programming/intel_software_optimization/17-1-0-329">Оптимизация ПО. Сборник рецептов</a><li><a href="http://progbook.ru/technologiya-programmirovaniya/617-kasperski-tehnika-optimizatsii-programm.html">Техника оптимизации программ. Эффективное использование памяти</a></ul><h3 id="комментарии"><span class="me-2">Комментарии</span><a href="#комментарии" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><blockquote><p><strong>mrdekk, 4 сент. 2010, 13:28</strong></p><p>Еще одной хорошей практикой является следующее:</p><p>Пусть у нас есть цикл</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">for</span> <span class="p">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="n">strlen</span><span class="p">(</span> <span class="n">string</span> <span class="p">);</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>
</pre></table></code></div></div><p>у нас на каждой итерации цикла вычисляется длина строки. Это плохо (за исключением когда строка в теле цикла меняется — но его мы рассматривать не будем). Лучше написать следующим образом:</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">for</span> <span class="p">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span> <span class="n">string</span> <span class="p">);</span> <span class="n">i</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="n">size</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>
</pre></table></code></div></div><p>И вообще — когда условие терминации цикла не меняется в ходе самого цикла (а в ином случае лучше использовать while) следует проводить предварительный расчет.</p></blockquote><blockquote><blockquote><p><strong>FiloXSee, 1 июля 2011, 17:43</strong></p><p>Подсказали хороший пример, как сделать код быстрее:</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>
</pre></table></code></div></div></blockquote></blockquote><blockquote><blockquote><blockquote><p><strong>FiloXSee, 1 июля 2011, 17:44</strong></p><p>Только нужно понимать что тут происходит. Этот вариант будет работать только со строками, которые заканчиваются нулем.</p></blockquote></blockquote></blockquote><blockquote><blockquote><p><strong>FiloXSee, 1 июля 2011, 17:55</strong></p><p>Мне тут подсказали такой вариант:</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="o">++</span><span class="n">i</span><span class="p">){}</span>
</pre></table></code></div></div><p>Предполагалось, что он будет еще быстрее, но это не так.</p><p>Вариант</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">for</span> <span class="p">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span> <span class="n">string</span> <span class="p">);</span> <span class="n">i</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="n">size</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</pre></table></code></div></div><p>будет в каждом витке цикла сравнивать две целые стековые переменные, а вариант</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</pre></table></code></div></div><p>будет вычислять текущий указатель, разыменовывать его получая по нему данные, брать от них только 1 байт и только потом сравнивать его с нулем. Это будет дольше, чем просто сравнение.</p></blockquote></blockquote><blockquote><p><strong>Saturn812, 14 мая 2011, 22:34</strong></p><p>Многие из этих вещей (особенно примитивные ++i vs i++) компилятор уже давно научился оптимизировать сам. А так вообще полезно для общего сведения.</p></blockquote><blockquote><blockquote><p><strong>FiloXSee, 17 мая 2011, 10:34</strong></p><p>Ты не совсем прав. Действительно в теле цикла разницы между вариантами</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Скопировано успешно!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">for</span><span class="p">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span>
</pre></table></code></div></div></blockquote></blockquote><blockquote><blockquote><blockquote><p><strong>FiloXSee, 17 мая 2011, 11:17</strong></p><p>В некоторых примерах смысл не в оптимизации компиляции, а в том, что процессор может одновременно выполнять несколько различных действий, например работать с целыми и вещественными типами, или выполнять арифметические операции и получать данные из памяти. Поэтому от того как написан код, процессор может выполнять эти операции последовательно или параллельно.</p><p>Если в компиляторе включена опция полной оптимизации, то компилятор может догадаться о некоторых вещах сам. Однако важно чтобы и программист понимал, как это все будет работать.</p></blockquote></blockquote></blockquote></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href='/categories/c/'>C++</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/c/" class="post-tag no-text-decoration" >c++</a> <a href="/tags/%D0%BE%D0%BF%D1%82%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F/" class="post-tag no-text-decoration" >оптимизация</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> Публикация защищена лицензией <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> .</div><div class="share-wrapper"> <span class="share-label text-muted me-1">Поделиться</span> <span class="share-icons"> <a href="https://t.me/share/url?url=http%3A%2F%2Fitw66.ru%2Fblog%2Fc_plus_plus%2F13.html&text=%D0%9E%D0%BF%D1%82%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%BA%D0%BE%D0%B4%D0%B0%20%D0%BD%D0%B0%20%D0%A1++%0A%20-%20It%20Works!" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram" > <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-bs-toggle="tooltip" data-bs-placement="top" title="Скопировать ссылку" data-title-succeed="Ссылка успешно скопирована!" > </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Недавно обновлено</div><ul class="post-content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/blog/china/2.html">Дух Китая. День второй </a><li class="text-truncate lh-lg"> <a href="/blog/china/4.html">Дух Китая. Пекин. Запретный город </a><li class="text-truncate lh-lg"> <a href="/blog/china/1.html">Дух Китая. Первый день, первые впечатления. </a><li class="text-truncate lh-lg"> <a href="/blog/12.html">5 инструментов работы с текстом которые вы обязаны знать </a><li class="text-truncate lh-lg"> <a href="/blog/c_plus_plus/14.html">Как избавится от vcredist'a </a></ul></div><div id="access-tags"><div class="panel-heading">Популярные теги</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/%D0%BA%D0%BE%D1%81%D0%BC%D0%BE%D1%81/">космос</a> <a class="post-tag btn btn-outline-primary" href="/tags/%D0%B0%D0%BB%D1%8C%D1%82%D0%B5%D1%80%D0%BD%D0%B0%D1%82%D0%B8%D0%B2%D0%BD%D0%B0%D1%8F-%D1%8D%D0%BD%D0%B5%D1%80%D0%B3%D0%B8%D1%8F/">альтернативная энергия</a> <a class="post-tag btn btn-outline-primary" href="/tags/%D1%81%D0%BE%D0%BB%D0%BD%D0%B5%D1%87%D0%BD%D0%B0%D1%8F-%D1%8D%D0%BD%D0%B5%D1%80%D0%B3%D0%B8%D1%8F/">солнечная энергия</a> <a class="post-tag btn btn-outline-primary" href="/tags/%D1%8D%D0%BD%D0%B5%D1%80%D0%B3%D0%B8%D1%8F-%D0%B2%D0%B5%D1%82%D1%80%D0%B0/">энергия ветра</a> <a class="post-tag btn btn-outline-primary" href="/tags/%D0%BA%D0%B8%D1%82%D0%B0%D0%B9/">китай</a> <a class="post-tag btn btn-outline-primary" href="/tags/%D0%B0%D0%BB%D1%8C%D1%82%D0%B5%D1%80%D0%BD%D0%B0%D1%82%D0%B8%D0%B2%D0%BD%D0%B0%D1%8F-%D1%8D%D0%BD%D0%B5%D1%80%D0%B3%D0%B5%D1%82%D0%B8%D0%BA%D0%B0/">альтернативная энергетика</a> <a class="post-tag btn btn-outline-primary" href="/tags/%D0%B2%D0%BE%D0%B4%D0%B0/">вода</a> <a class="post-tag btn btn-outline-primary" href="/tags/%D1%8D%D0%BA%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D1%8F/">экология</a> <a class="post-tag btn btn-outline-primary" href="/tags/c/">c++</a> <a class="post-tag btn btn-outline-primary" href="/tags/%D0%B7%D0%B5%D0%BC%D0%BB%D1%8F/">земля</a></div></div></div><div id="toc-wrapper" class="ps-0 pe-4 mb-5"><div class="panel-heading ps-3 pt-2 mb-2">Содержание</div><nav id="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-3 pe-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ms-1" data-toc-skip> Вам также может быть интересно</h3><div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><div class="col"> <a href="/blog/c_plus_plus/471.html" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1305568800" data-df="DD/MM/YYYY" > 17/05/2011 </em><h4 class="pt-0 my-2" data-toc-skip>Placement new, или как создать объект в выделенной памяти</h4><div class="text-muted small"><p> Как понятно из названия, в данной статье речь пойдет о том, как создать объект в выделенной памяти и зачем это может быть необходимо. Работа с памятью через оператор new может быть крайне не желат...</p></div></div></a></div><div class="col"> <a href="/blog/c_plus_plus/481.html" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1306260000" data-df="DD/MM/YYYY" > 25/05/2011 </em><h4 class="pt-0 my-2" data-toc-skip>Вычисление суммы элементов массива с сохранением точности</h4><div class="text-muted small"><p> На сайте вакансий Яндекса предлагают вычислить сумму элементов массива и предлагают три варианта решения задачи. Эти примеры намеренно не оптимальны и существует лучшее решение задачи. Рассмотрим с...</p></div></div></a></div><div class="col"> <a href="/blog/c_plus_plus/501.html" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1309629600" data-df="DD/MM/YYYY" > 03/07/2011 </em><h4 class="pt-0 my-2" data-toc-skip>Использование Precompiled файла, для ускорения компиляции</h4><div class="text-muted small"><p> Реальные приложения могут иметь множество проектов в одном салюшине в Visual Studio. Эти проекты могут содержать сотни файлов исходного кода и это несомненно скажется на времени компиляции. Существ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/blog/c_plus_plus/14.html" class="btn btn-outline-primary" prompt="Следующая публикация" ><p>Как избавится от vcredist'a</p></a> <a href="/blog/c_plus_plus/15.html" class="btn btn-outline-primary" prompt="Предыдущая публикация" ><p>Тест на быстродействие: Hash Map vs Vector</p></a></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Популярные теги</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/%D0%BA%D0%BE%D1%81%D0%BC%D0%BE%D1%81/">космос</a> <a class="post-tag btn btn-outline-primary" href="/tags/%D0%B0%D0%BB%D1%8C%D1%82%D0%B5%D1%80%D0%BD%D0%B0%D1%82%D0%B8%D0%B2%D0%BD%D0%B0%D1%8F-%D1%8D%D0%BD%D0%B5%D1%80%D0%B3%D0%B8%D1%8F/">альтернативная энергия</a> <a class="post-tag btn btn-outline-primary" href="/tags/%D1%81%D0%BE%D0%BB%D0%BD%D0%B5%D1%87%D0%BD%D0%B0%D1%8F-%D1%8D%D0%BD%D0%B5%D1%80%D0%B3%D0%B8%D1%8F/">солнечная энергия</a> <a class="post-tag btn btn-outline-primary" href="/tags/%D1%8D%D0%BD%D0%B5%D1%80%D0%B3%D0%B8%D1%8F-%D0%B2%D0%B5%D1%82%D1%80%D0%B0/">энергия ветра</a> <a class="post-tag btn btn-outline-primary" href="/tags/%D0%BA%D0%B8%D1%82%D0%B0%D0%B9/">китай</a> <a class="post-tag btn btn-outline-primary" href="/tags/%D0%B0%D0%BB%D1%8C%D1%82%D0%B5%D1%80%D0%BD%D0%B0%D1%82%D0%B8%D0%B2%D0%BD%D0%B0%D1%8F-%D1%8D%D0%BD%D0%B5%D1%80%D0%B3%D0%B5%D1%82%D0%B8%D0%BA%D0%B0/">альтернативная энергетика</a> <a class="post-tag btn btn-outline-primary" href="/tags/%D0%B2%D0%BE%D0%B4%D0%B0/">вода</a> <a class="post-tag btn btn-outline-primary" href="/tags/%D1%8D%D0%BA%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D1%8F/">экология</a> <a class="post-tag btn btn-outline-primary" href="/tags/c/">c++</a> <a class="post-tag btn btn-outline-primary" href="/tags/%D0%B7%D0%B5%D0%BC%D0%BB%D1%8F/">земля</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div></div><footer><div class="container px-lg-4"><div class="d-flex justify-content-center align-items-center text-muted mx-md-3"><p>Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme</p><p>© 2023 <a href=""></a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Публикации на сайте защищены лицензией Creative Commons Attribution 4.0 International (CC BY 4.0), если в тексте публикации не указано иное." >Некоторые права защищены.</span></p></div></div></footer><div id="mask"></div><button id="back-to-top" aria-label="back-to-top" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">Доступна новая версия контента.</p><button type="button" class="btn btn-primary" aria-label="Update"> Обновлять </button></div></div><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.0/dist/jquery.min.js,npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.7/dayjs.min.js,npm/dayjs@1.11.7/locale/ru.min.js,npm/dayjs@1.11.7/plugin/relativeTime.min.js,npm/dayjs@1.11.7/plugin/localizedFormat.min.js,npm/tocbot@4.21.0/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-16734363-3"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-16734363-3'); }); </script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="px-1 px-sm-2 px-lg-4 px-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="//mc.yandex.ru/metrika/watch.js" type="text/javascript"></script><div style="display:none;"><script type="text/javascript"> try { var yaCounter1534027 = new Ya.Metrika(1534027); } catch(e){} </script></div><noscript><div style="position:absolute"><img src="//mc.yandex.ru/watch/1534027" alt="" /></div></noscript>
